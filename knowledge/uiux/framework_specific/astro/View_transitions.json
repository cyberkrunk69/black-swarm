{
  "id": "astro__en_guides_view-transitions_",
  "source_id": "astro",
  "source_name": "Astro Documentation",
  "category": "framework_specific",
  "url": "https://docs.astro.build/en/guides/view-transitions/",
  "title": "View transitions",
  "content": "View transitions\nView transitions\nare animated transitions between different website views. They are a popular design choice for preserving visual continuity as visitors move between states or views of an application.\nAstro\u2019s view transitions and client-side routing support is powered by the\nView Transitions browser API\nand also includes:\nA few\nbuilt-in animation options\n, such as\nfade\n,\nslide\n, and\nnone\n.\nSupport for both forwards and backwards navigation animations.\nThe ability to fully\ncustomize all aspects of transition animation\n, and build your own animations.\nA way to carry HTML elements from the current page to the next during navigation.\nThe option to\nprevent client-side navigation for non-page links\n.\nControl over fallback behavior\nfor browsers that do not yet support the View Transition APIs.\nAutomatic support for\nprefers-reduced-motion\n.\nDifferences between browser-native view transitions and Astro\u2019s\n<ClientRouter />\nSection titled \u201cDifferences between browser-native view transitions and Astro\u2019s <ClientRouter />\u201d\nBrowser-native, cross-document view transitions\ncan be used in Astro to animate the navigation between documents in a multi-page app (MPA), often providing the experience of client-side routing of single-page applications. They don\u2019t alter the core functionality of a multi-page application, nor do they affect any existing scripts or add additional JavaScript to your page load. They simply add animations.\nFor enhanced client-side routing and view transition features not yet fully supported by the View Transition API, Astro provides a built-in, lightweight component to enable client-side routing and turn your multi-page app into a\nsingle-page app\nwith smooth animations on navigation.\nThat comes with some benefits, like shared state across pages and persistent elements, and some drawbacks, such as needing to manually reinitialize scripts or state after navigation.\nAdding Astro\u2019s built-in\n<ClientRouter />\ncomponent:\nintercepts page navigation\nand gives you considerable control over this process.\nextends and enhances some View Transition/Navigation API features.\nallows you to\nconfigure fallback strategies\nfor when\nnative browser support is lacking\n.\nHowever, as browser APIs and web standards evolve, using Astro\u2019s\n<ClientRouter />\nfor this additional functionality\nwill increasingly become unnecessary\n. We recommend keeping up with the current state of browser APIs so you can\ndecide whether you still need Astro\u2019s client-side routing\nfor the specific features you use.\nEnabling view transitions (SPA mode)\nSection titled \u201cEnabling view transitions (SPA mode)\u201d\nImport and add the\n<ClientRouter />\ncomponent to your common\n<head>\nor shared layout component. Astro will create default page animations based on the similarities between the old and new page, and will also provide fallback behavior for unsupported browsers.\nThe example below shows adding Astro\u2019s default page navigation animations site-wide, including the default fallback control option for non-supporting browsers, by importing and adding this component to a\n<CommonHead />\nAstro component:\nsrc/components/CommonHead.astro\n---\nimport\n{ ClientRouter }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\nlink\nrel\n=\n\"\nicon\n\"\ntype\n=\n\"\nimage/svg+xml\n\"\nhref\n=\n\"\n/favicon.svg\n\"\n/>\n<\nmeta\nname\n=\n\"\ngenerator\n\"\ncontent\n=\n{\nAstro\n.\ngenerator\n}\n/>\n<!-- Primary Meta Tags -->\n<\ntitle\n>\n{\ntitle\n}\n</\ntitle\n>\n<\nmeta\nname\n=\n\"\ntitle\n\"\ncontent\n=\n{\ntitle\n}\n/>\n<\nmeta\nname\n=\n\"\ndescription\n\"\ncontent\n=\n{\ndescription\n}\n/>\n<\nClientRouter\n/>\nNo other configuration is necessary to enable Astro\u2019s default client-side navigation!\nUse\ntransition directives\nor\noverride default client-side navigation\non individual elements for finer control.\nTransition Directives\nSection titled \u201cTransition Directives\u201d\nAstro will automatically assign corresponding elements found in both the old page and the new page a shared, unique\nview-transition-name\n. This pair of matching elements is inferred by both the type of element and its location in the DOM.\nUse optional\ntransition:*\ndirectives on page elements in your\n.astro\ncomponents for finer control over the page transition behaviour during navigation.\ntransition:name\n: Allows you to override Astro\u2019s default element matching for old/new content animation and\nspecify a transition name\nto associate a pair of DOM elements.\ntransition:animate\n: Allows you to override Astro\u2019s default animation while replacing the old element with the new one by specifying an animation type. Use Astro\u2019s\nbuilt-in animation directives\nor\ncreate custom transition animations\n.\ntransition:persist\n: Allows you to override Astro\u2019s default replacing old elements for new ones and instead\npersist components and HTML elements\nwhen navigating to another page.\nNaming a transition\nSection titled \u201cNaming a transition\u201d\nIn some cases, you may want or need to identify the corresponding view transition elements yourself. You can specify a name for a pair of elements using the\ntransition:name\ndirective.\nsrc/pages/old-page.astro\n<\naside\ntransition:name\n=\n\"\nhero\n\"\n>\nsrc/pages/new-page.astro\n<\naside\ntransition:name\n=\n\"\nhero\n\"\n>\nNote that the provided\ntransition:name\nvalue can only be used once on each page. Set this manually when Astro can\u2019t infer a proper name itself, or for more fine control over matching elements.\nMaintaining State\nSection titled \u201cMaintaining State\u201d\nAdded in:\nastro@2.10.0\nYou can persist components and HTML elements (instead of replacing them) across page navigations using the\ntransition:persist\ndirective.\nFor example, the following\n<video>\nwill continue to play as you navigate to another page that contains the same video element. This works for both forwards and backwards navigation.\nsrc/components/Video.astro\n<\nvideo\ncontrols\nmuted\nautoplay\ntransition:persist\n>\n<\nsource\nsrc\n=\n\"\nhttps://ia804502.us.archive.org/33/items/GoldenGa1939_3/GoldenGa1939_3_512kb.mp4\n\"\ntype\n=\n\"\nvideo/mp4\n\"\n/>\n</\nvideo\n>\nYou can also place the directive on an\nAstro island\n(a UI framework component with a\nclient:\ndirective\n). If that component exists on the next page, the island from the old page\nwith its current state\nwill continue to be displayed, instead of replacing it with the island from the new page.\nIn the example below, the component\u2019s internal state of the count will not be reset when navigating back and forth across pages that contain the\n<Counter />\ncomponent with the\ntransition:persist\nattribute.\ncomponents/Header.astro\n<\nCounter\nclient:load\ntransition:persist\ninitialCount\n=\n{\n5\n}\n/>\nYou can also\nmanually identify corresponding elements\nif the island/element is in a different component between the two pages.\nsrc/pages/old-page.astro\n<\nvideo\ncontrols\nmuted\nautoplay\ntransition:name\n=\n\"\nmedia-player\n\"\ntransition:persist\n/>\nsrc/pages/new-page.astro\n<\nMyVideo\ncontrols\nmuted\nautoplay\ntransition:name\n=\n\"\nmedia-player\n\"\ntransition:persist\n/>\nAs a convenient shorthand,\ntransition:persist\ncan alternatively take a transition name as a value.\nsrc/pages/index.astro\n<\nvideo\ncontrols\nmuted\nautoplay\ntransition:persist\n=\n\"\nmedia-player\n\"\n>\ntransition:persist-props\nSection titled \u201ctransition:persist-props\u201d\nAdded in:\nastro@4.5.0\nThis allows you to control whether or not an island\u2019s props should be persisted upon navigation.\nBy default, when you add\ntransition:persist\nto an island, the state is retained upon navigation, but your component will re-render with new props. This is useful, for example, when a component receives page-specific props such as the current page\u2019s\ntitle\n.\nYou can override this behavior by setting\ntransition:persist-props\nin addition to\ntransition:persist\n. Adding this directive will keep an island\u2019s existing props (not re-render with new values) in addition to maintaining its existing state.\nBuilt-in Animation Directives\nSection titled \u201cBuilt-in Animation Directives\u201d\nAstro comes with a few built-in animations to override the default\nfade\ntransition. Add the\ntransition:animate\ndirective to individual elements to customize the behavior of specific transitions.\nfade\n(default): An opinionated crossfade animation. The old content fades out and the new content fades in.\ninitial\n: Opt out of Astro\u2019s opinionated crossfade animation and use the browser\u2019s default styling.\nslide\n: An animation where the old content slides out to the left and new content slides in from the right. On backwards navigation, the animations are the opposite.\nnone\n: Disable the browser\u2019s default animations. Use on a page\u2019s\n<html>\nelement to disable the default fade for every element on the page.\nCombine directives for full control over your page animation. Set a page default on the\n<html>\nelement, and override on any individual elements as desired.\nThe example below produces a slide animation for the body content while disabling the browser\u2019s default fade animation for the rest of the page:\n---\nimport\nCommonHead\nfrom\n\"\n../components/CommonHead.astro\n\"\n;\n---\n<\nhtml\ntransition:name\n=\n\"\nroot\n\"\ntransition:animate\n=\n\"\nnone\n\"\n>\n<\nhead\n>\n<\nCommonHead\n/>\n</\nhead\n>\n<\nbody\n>\n<\nheader\n>\n...\n</\nheader\n>\n<!-- Override your page default on a single element -->\n<\nmain\ntransition:animate\n=\n\"\nslide\n\"\n>\n...\n</\nmain\n>\n</\nbody\n>\n</\nhtml\n>\nCustomizing Animations\nSection titled \u201cCustomizing Animations\u201d\nYou can customize all aspects of a transition with any CSS animation properties.\nTo customize a built-in animation, first import the animation from\nastro:transitions\n, and then pass in customization options.\nThe example below customizes the duration of the built-in\nfade\nanimation:\n---\nimport\n{ fade }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\nheader\ntransition:animate\n=\n{\nfade\n(\n{ duration:\n\"\n0.4s\n\"\n}\n)\n}\n>\nYou can also define your own animations for use with\ntransition:animate\nby defining both the forwards and backwards behavior, as well as new and old pages, according to the following types:\nexport\ninterface\nTransitionAnimation {\nname\n:\nstring\n;\n// The name of the keyframe\ndelay\n?:\nnumber\n|\nstring\n;\nduration\n?:\nnumber\n|\nstring\n;\neasing\n?:\nstring\n;\nfillMode\n?:\nstring\n;\ndirection\n?:\nstring\n;\n}\nexport\ninterface\nTransitionAnimationPair {\nold\n:\nTransitionAnimation\n|\nTransitionAnimation\n[];\nnew\n:\nTransitionAnimation\n|\nTransitionAnimation\n[];\n}\nexport\ninterface\nTransitionDirectionalAnimations {\nforwards\n:\nTransitionAnimationPair\n;\nbackwards\n:\nTransitionAnimationPair\n;\n}\nThe following example shows all the necessary properties to define a custom\nbump\nanimation inside a\n<style is:global>\ntag in your root layout file:\nsrc/layouts/Layout.astro\n---\nimport\n{ ClientRouter }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\nhtml\nlang\n=\n\"\nen\n\"\n>\n<\nhead\n>\n<\nClientRouter\n/>\n</\nhead\n>\n<\nbody\n>\n<\nslot\n/>\n</\nbody\n>\n</\nhtml\n>\n<\nstyle\nis:global\n>\n@keyframes\nbump\n{\n0% {\nopacity\n:\n0\n;\ntransform\n:\nscale\n(\n1\n)\ntranslateX\n(\n200\npx\n);\n}\n50% {\nopacity\n:\n0.5\n;\ntransform\n:\nscale\n(\n1.1\n);\n}\n100% {\nopacity\n:\n1\n;\ntransform\n:\nscale\n(\n1\n)\ntranslateX\n(\n0\n);\n}\n}\n</\nstyle\n>\nThe animation\u2019s behavior must be defined in the frontmatter of every component using the animation:\nsrc/pages/index.astro\n---\nconst\nanim\n= {\nold: {\nname:\n\"\nbump\n\"\n,\nduration:\n\"\n0.5s\n\"\n,\neasing:\n\"\nease-in\n\"\n,\ndirection:\n\"\nreverse\n\"\n,\n},\nnew: {\nname:\n\"\nbump\n\"\n,\nduration:\n\"\n0.5s\n\"\n,\neasing:\n\"\nease-in-out\n\"\n,\n},\n}\n;\nconst\ncustomTransition\n= {\nforwards:\nanim\n,\nbackwards:\nanim\n,\n}\n;\n---\n<\nheader\ntransition:animate\n=\n{\ncustomTransition\n}\n>\n...\n</\nheader\n>\nYou have great flexibility when defining custom animations. To achieve your desired result, you may wish to consider unusual combinations such as using different objects for forward and backward, or providing separate keyframe animations for old and new.\nRouter control\nSection titled \u201cRouter control\u201d\nThe\n<ClientRouter />\nrouter handles navigation by listening to:\nClicks on\n<a>\nelements.\nBackwards and forwards navigation events.\nThe following options allow you to further control when navigation occurs within the router:\ndata-astro-reload\n: an\n<a>\ntag attribute to\nforce a full-page navigation\ndata-astro-history=\"auto | push | replace\"\n: an\n<a>\ntag attribute to\ncontrol the browser\u2019s history\nnavigate(href, options)\n: a method available to any client script or client component to\ntrigger navigation\nPreventing client-side navigation\nSection titled \u201cPreventing client-side navigation\u201d\nThere are some cases where you cannot navigate via client-side routing since both pages involved must use the\n<ClientRouter />\nrouter to prevent a full-page reload. You may also not want client-side routing on every navigation change and would prefer a traditional page navigation on select routes instead.\nYou can opt out of client-side routing on a per-link basis by adding the\ndata-astro-reload\nattribute to any\n<a>\nor\n<form>\ntag. This attribute will override any existing\n<ClientRouter />\ncomponent and instead trigger a browser refresh during navigation.\nThe following example shows preventing client-side routing when navigating to an article from the home page only. This still allows you to have animation on shared elements, such as a hero image, when navigating to the same page from an article listing page:\nsrc/pages/index.astro\n<\na\nhref\n=\n\"\n/articles/emperor-penguins\n\"\ndata-astro-reload\n>\nsrc/pages/articles.astro\n<\na\nhref\n=\n\"\n/articles/emperor-penguins\n\"\n>\nLinks with the\ndata-astro-reload\nattribute will be ignored by the router and a full-page navigation will occur.\nTrigger navigation\nSection titled \u201cTrigger navigation\u201d\nYou can also trigger client-side navigation via events not normally listened to by the\n<ClientRouter />\nrouter using\nnavigate()\n. This function from the\nastro:transitions/client\nmodule can be used in scripts, and in framework components that are hydrated with a\nclient directive\n.\nThe following example shows an Astro component that navigates a visitor to another page they select from a menu:\nsrc/components/Form.astro\n<\nscript\n>\nimport\n{ navigate }\nfrom\n\"\nastro:transitions/client\n\"\n;\n// Navigate to the selected option automatically.\ndocument\n.\nquerySelector\n(\n\"\nselect\n\"\n)\n.\nonchange\n=\n(\nevent\n)\n=>\n{\nlet\nhref\n=\nevent\n.\ntarget\n.\nvalue\n;\nnavigate\n(\nhref\n);\n};\n</\nscript\n>\n<\nselect\n>\n<\noption\nvalue\n=\n\"\n/play\n\"\n>\nPlay\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/blog\n\"\n>\nBlog\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/about\n\"\n>\nAbout\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/contact\n\"\n>\nContact\n</\noption\n>\n</\nselect\n>\nsrc/pages/index.astro\n---\nimport\nForm\nfrom\n\"\n../components/Form.astro\n\"\n;\nimport\n{ ClientRouter }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\nhtml\n>\n<\nhead\n>\n<\nClientRouter\n/>\n</\nhead\n>\n<\nbody\n>\n<\nForm\n/>\n</\nbody\n>\n</\nhtml\n>\nThe following example implements the same using\nnavigate()\nin a React\n<Form />\ncomponent:\nsrc/components/Form.jsx\nimport\n{ navigate }\nfrom\n\"\nastro:transitions/client\n\"\n;\nexport\ndefault\nfunction\nForm\n()\n{\nreturn\n(\n<\nselect\nonChange\n=\n{\n(\ne\n)\n=>\nnavigate\n(\ne\n.\ntarget\n.\nvalue\n)\n}\n>\n<\noption\nvalue\n=\n\"\n/play\n\"\n>\nPlay\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/blog\n\"\n>\nBlog\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/about\n\"\n>\nAbout\n</\noption\n>\n<\noption\nvalue\n=\n\"\n/contact\n\"\n>\nContact\n</\noption\n>\n</\nselect\n>\n);\n}\nThe\n<Form />\ncomponent can then be rendered on an Astro page that uses the\n<ClientRouter />\nrouter, with a client directive:\nsrc/pages/index.astro\n---\nimport\nForm\nfrom\n\"\n../components/Form.jsx\n\"\n;\nimport\n{ ClientRouter }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\nhtml\n>\n<\nhead\n>\n<\nClientRouter\n/>\n</\nhead\n>\n<\nbody\n>\n<\nForm\nclient:load\n/>\n</\nbody\n>\n</\nhtml\n>\nFor backward and forward navigation through the browser history, you can combine\nnavigate()\nwith the built-in\nhistory.back()\n,\nhistory.forward()\nand\nhistory.go()\nfunctions of the browser. If\nnavigate()\nis called during the server-side render of your component, it has no effect.\nSee the\nastro:transitions\nreference for more information about the\nnavigate()\noptions\n.\nReplace entries in the browser history\nSection titled \u201cReplace entries in the browser history\u201d\nNormally, each time you navigate, a new entry is written to the browser\u2019s history. This allows navigation between pages using the browser\u2019s\nback\nand\nforward\nbuttons.\nThe\n<ClientRouter />\nrouter allows you to overwrite history entries by adding the\ndata-astro-history\nattribute to any individual\n<a>\ntag.\nThe\ndata-astro-history\nattribute can be set to the same three values as the\nhistory\noption of the\nnavigate()\nfunction\n:\n\"push\"\n: the router will use\nhistory.pushState\nto create a new entry in the browser history.\n\"replace\"\n: the router will use\nhistory.replaceState\nto update the URL without adding a new entry into navigation.\n\"auto\"\n(default): the router will attempt\nhistory.pushState\n, but if the URL is not one that can be transitioned to, the current URL will remain with no changes to the browser history.\nThe following example navigates to the\n/main\npage but does not add a new entry to the browsing history. Instead, it reuses the current entry in the history (\n/confirmation\n) and overwrites it.\nsrc/pages/confirmation.astro\n<\na\nhref\n=\n\"\n/main\n\"\ndata-astro-history\n=\n\"\nreplace\n\"\n>\nThis has the effect that if you go back from the\n/main\npage, the browser will not display the\n/confirmation\npage, but the page before it.\nTransitions with forms\nSection titled \u201cTransitions with forms\u201d\nAdded in:\nastro@4.0.0\nThe\n<ClientRouter />\nrouter will trigger in-page transitions from\n<form>\nelements, supporting both\nGET\nand\nPOST\nrequests.\nBy default, Astro submits your form data as\nmultipart/form-data\nwhen your\nmethod\nis set to\nPOST\n. If you want to match the default behavior of web browsers, use the\nenctype\nattribute to submit your data encoded as\napplication/x-www-form-urlencoded\n:\nsrc/components/Form.astro\n<\nform\naction\n=\n\"\n/contact\n\"\nmethod\n=\n\"\nPOST\n\"\nenctype\n=\n\"\napplication/x-www-form-urlencoded\n\"\n>\nYou can opt out of router transitions on any individual form using the\ndata-astro-reload\nattribute:\nsrc/components/Form.astro\n<\nform\naction\n=\n\"\n/contact\n\"\ndata-astro-reload\n>\nNavigating with user input\nSection titled \u201cNavigating with user input\u201d\nThe\nnavigate()\nAPI does not perform sanitization on the URLs passed to it. If you are using user input to determine the URL to navigate to, you should validate the input before passing it to\nnavigate()\n.\nFor example, a\n?redirect\nquery parameter could be used to navigate away from your site (\n?redirect=http://example.com\n) or to execute arbitrary code (\n?redirect=javascript:alert('Evil code')\n) if the value is not sanitized before use.\nOne way to implement this safely is to ensure only a set of known paths can be redirected to:\nsrc/pages/index.astro\n<\nscript\n>\nimport\n{ navigate }\nfrom\n'\nastro:transitions/client\n'\n;\nconst\nparams\n=\nnew\nURLSearchParams\n(\nwindow\n.\nlocation\n.\nsearch\n);\nconst\nredirect\n=\nparams\n.\nget\n(\n'\nredirect\n'\n);\nconst\nallowedPaths\n=\n[\n'\n/home\n'\n,\n'\n/about\n'\n,\n'\n/contact\n'\n];\nif\n(\nallowedPaths\n.\nincludes\n(\nredirect\n)) {\nnavigate\n(\nredirect\n);\n}\n</\nscript\n>\nThe exact kind of sanitization you need will depend on your site and what you want to allow.\nConsider enabling Astro\u2019s\nexperimental Content Security Policy feature\nto help protect against cross-site scripting (XSS) risks if using user input with the\nnavigate()\nAPI.\nFallback control\nSection titled \u201cFallback control\u201d\nThe\n<ClientRouter />\nrouter works best in browsers that support View Transitions (i.e. Chromium browsers), but also includes default fallback support for other browsers. Even if the browser does not support the View Transitions API, Astro\u2019s client router can still provide in-browser navigation using one of the fallback options.\nDepending on browser support, you may need to explicitly set the\nname\nor\nanimate\ntransition directives\non the elements you wish to animate for a comparable experience across all browsers:\nsrc/pages/about.astro\n---\nimport\nLayout\nfrom\n\"\n../layouts/LayoutUsingClientRouter.astro\n\"\n;\n---\n<\ntitle\ntransition:animate\n=\n\"\nfade\n\"\n>\nAbout my site\n</\ntitle\n>\nYou can override Astro\u2019s default fallback support by adding a\nfallback\nproperty on the\n<ClientRouter />\ncomponent and setting it to\nswap\nor\nnone\n:\nanimate\n(default, recommended): Astro will simulate view transitions using custom attributes before updating page content.\nswap\n: Astro will not attempt to animate the page. Instead, the old page will be immediately replaced by the new one.\nnone\n: Astro will not do any animated page transitions at all. Instead, you will get full page navigation in non-supporting browsers.\n---\nimport\n{ ClientRouter }\nfrom\n\"\nastro:transitions\n\"\n;\n---\n<\ntitle\n>\nMy site\n</\ntitle\n>\n<\nClientRouter\nfallback\n=\n\"\nswap\n\"\n/>\nClient-side navigation process\nSection titled \u201cClient-side navigation process\u201d\nWhen using the\n<ClientRouter />\nrouter, the following steps occur to produce Astro\u2019s client-side navigation:\nA visitor to your site triggers navigation by any of the following actions:\nClicking an\n<a>\ntag linking internally to another page on your site.\nClicking the back button.\nClicking the forward button.\nThe router starts fetching the next page.\nThe router adds the\ndata-astro-transition\nattribute to the HTML element with a value of\n\"forward\"\nor\n\"back\"\nas appropriate.\nThe router calls\ndocument.startViewTransition\n. This triggers the browser\u2019s own\nview transition process\n. Importantly, the browser screenshots the current state of the page.\nInside the\nstartViewTransition\ncallback, the router performs a\nswap\n, which consists of the following sequence of events:\nThe contents of the\n<head>\nare swapped out, with some elements kept:\nStylesheet DOM nodes are left in if they exist on the new page, to prevent FOUC.\nScripts are left in if they exist on the new page.\nAny other head elements with\ntransition:persist\nare left in if there is a corresponding element in the new page.\nThe\n<body>\nis completely replaced with the new page\u2019s body.\nElements marked\ntransition:persist\nare moved over to the new DOM if they exist on the new page.\nScroll position is restored if necessary.\nThe\nastro:after-swap\nevent is triggered on the\ndocument\n. This is the end of the\nswap\nprocess.\nThe router waits for any new stylesheets to load before resolving the transition.\nThe router executes any new scripts added to the page.\nThe\nastro:page-load\nevent fires. This is the end of the navigation process.\nScript behavior with view transitions\nSection titled \u201cScript behavior with view transitions\u201d\nWhen you add view transitions to an existing Astro project, some of your scripts may no longer re-run after page navigation like they did with full-page browser refreshes. Use the following information to ensure that your scripts execute as expected.\nScript order\nSection titled \u201cScript order\u201d\nWhen navigating between pages with the\n<ClientRouter />\ncomponent, scripts are run in sequential order to match browser behavior.\nScript re-execution\nSection titled \u201cScript re-execution\u201d\nBundled module scripts\n, which are the default scripts in Astro, are only ever executed once. After initial execution they will be ignored, even if the script exists on the new page after a transition.\nUnlike bundled module scripts,\ninline scripts\nhave the potential to be re-executed during a user\u2019s visit to a site if they exist on a page that is visited multiple times. Inline scripts might also re-execute when a visitor navigates to a page without the script, and then back to one with the script.\nWith view transitions, some scripts may no longer re-run after page navigation like they do with full-page browser refreshes. There are several\nevents during client-side routing that you can listen for\n, and fire events when they occur. You can wrap an existing script in an event listener to ensure it runs at the proper time in the navigation cycle.\nThe following example wraps a script for a mobile \u201chamburger\u201d menu in an event listener for\nastro:page-load\nwhich runs at the end of page navigation to make the menu responsive to being clicked after navigating to a new page:\nsrc/scripts/menu.js\ndocument\n.\naddEventListener\n(\n\"\nastro:page-load\n\"\n,\n()\n=>\n{\ndocument\n.\nquerySelector\n(\n\"\n.hamburger\n\"\n)\n.\naddEventListener\n(\n\"\nclick\n\"\n,\n()\n=>\n{\ndocument\n.\nquerySelector\n(\n\"\n.nav-links\n\"\n)\n.\nclassList\n.\ntoggle\n(\n\"\nexpanded\n\"\n);\n});\n});\nThe following example shows a function that runs in response to the\nastro:after-swap\nevent, which happens immediately after the new page has replaced the old page and before the DOM elements are painted to the screen. This avoids a flash of light mode theme after page navigation by checking and, if necessary, setting the dark mode theme before the new page is rendered:\nsrc/components/ThemeToggle.astro\n<\nscript\nis:inline\n>\nfunction\napplyTheme\n()\n{\nlocalStorage\n.\ntheme\n===\n\"\ndark\n\"\n?\ndocument\n.\ndocumentElement\n.\nclassList\n.\nadd\n(\n\"\ndark\n\"\n)\n:\ndocument\n.\ndocumentElement\n.\nclassList\n.\nremove\n(\n\"\ndark\n\"\n);\n}\ndocument\n.\naddEventListener\n(\n\"\nastro:after-swap\n\"\n,\napplyTheme\n);\napplyTheme\n();\n</\nscript\n>\ndata-astro-rerun\nSection titled \u201cdata-astro-rerun\u201d\nAdded in:\nastro@4.5.0\nTo force inline scripts to re-execute after every transition, add the\ndata-astro-rerun\nproperty. Adding any attribute to a script also implicitly adds\nis:inline\n, so this is only available for scripts that are not bundled and processed by Astro.\n<\nscript\nis:inline\ndata-astro-rerun\n>\n...\n</\nscript\n>\nTo ensure that a script runs every time a page is loaded during client-side navigation, it should be executed by a\nlifecycle event\n. For example, event listeners for\nDOMContentLoaded\ncan be replaced by the\nastro:page-load\nlifecycle event.\nIf you have code that sets up a global state in an inline script, this state will need to take into account that the script might execute more than once. Check for the global state in your\n<script>\ntag, and conditionally execute your code where possible. This works because\nwindow\nis preserved.\n<\nscript\nis:inline\n>\nif\n(\n!\nwindow\n.\nSomeGlobal\n) {\nwindow\n.\nSomeGlobal\n=\n{};\n}\n</\nscript\n>\nLifecycle events\nSection titled \u201cLifecycle events\u201d\nThe\n<ClientRouter />\nrouter fires a number of events on the\ndocument\nduring navigation. These events provide hooks into the lifecycle of navigation, allowing you to do things like show indicators that a new page is loading, override default behavior, and restore state as navigation is completing.\nThe navigation process involves a\npreparation\nphase, when new content is loaded; a\nDOM swap\nphase, where the old page\u2019s content is replaced by the new page\u2019s content; and a\ncompletion\nphase where scripts are executed, loading is reported as completed and clean-up work is carried out.\nAstro\u2019s View Transition API lifecycle events in order are:\nastro:before-preparation\nastro:after-preparation\nastro:before-swap\nastro:after-swap\nastro:page-load\nWhile some actions can be triggered during any event, some tasks can only be performed during a specific event for best results, such as displaying a loading spinner before preparation or overriding animation pairs before swapping content.\nastro:before-preparation\nSection titled \u201castro:before-preparation\u201d\nAdded in:\nastro@3.6.0\nAn event that fires at the beginning of the preparation phase, after navigation has started (e.g. after the user has clicked a link), but before content is loaded.\nThis event is used:\nTo do something before loading has started, such as showing a loading spinner.\nTo alter loading, such as loading content you\u2019ve defined in a template rather than from the external URL.\nTo change the\ndirection\nof the navigation (which is usually either\nforward\nor\nbackward\n) for custom animation.\nHere is an example of using the\nastro:before-preparation\nevent to load a spinner before the content is loaded and stop it immediately after loading. Note that using the\nloader\ncallback\nin this way allows asynchronous execution of code.\n<\nscript\nis:inline\n>\ndocument\n.\naddEventListener\n(\n\"\nastro:before-preparation\n\"\n,\n(\nevent\n)\n=>\n{\nconst\noriginalLoader\n=\nevent\n.\nloader\n;\nevent\n.\nloader\n=\nasync\nfunction\n()\n{\nconst {\nstartSpinner\n} = await\nimport\n(\n\"\n./spinner.js\n\"\n);\nconst\nstop\n=\nstartSpinner\n();\nawait\noriginalLoader\n();\nstop\n();\n};\n});\n</\nscript\n>\nastro:after-preparation\nSection titled \u201castro:after-preparation\u201d\nAdded in:\nastro@3.6.0\nAn event that fires at the end of the preparation phase, after the new page\u2019s content has been loaded and parsed into a document. This event occurs before the view transitions phase.\nThis example uses the\nastro:before-preparation\nevent to start a loading indicator and the\nastro:after-preparation\nevent to stop it:\n<\nscript\nis:inline\n>\ndocument\n.\naddEventListener\n(\n\"\nastro:before-preparation\n\"\n,\n()\n=>\n{\ndocument\n.\nquerySelector\n(\n\"\n#loading\n\"\n)\n.\nclassList\n.\nadd\n(\n\"\nshow\n\"\n);\n});\ndocument\n.\naddEventListener\n(\n\"\nastro:after-preparation\n\"\n,\n()\n=>\n{\ndocument\n.\nquerySelector\n(\n\"\n#loading\n\"\n)\n.\nclassList\n.\nremove\n(\n\"\nshow\n\"\n);\n});\n</\nscript\n>\nThis is a simpler version of loading a spinner than the example shown above: if all of the listener\u2019s code can be executed synchronously, there is no need to hook into the\nloader\ncallback.\nastro:before-swap\nSection titled \u201castro:before-swap\u201d\nAdded in:\nastro@3.6.0\nAn event that fires before the new document (which is populated during the preparation phase) replaces the current document. This event occurs inside of the view transition, where the user is still seeing a snapshot of the old page.\nThis event can be used to make changes before the swap occurs. The\nnewDocument\nproperty on the event represents the incoming document. Here is an example of ensuring the browser\u2019s light or dark mode preference in\nlocalStorage\nis carried over to the new page:\n<\nscript\n>\ndocument\n.\naddEventListener\n(\n\"\nastro:before-swap\n\"\n,\n(\nevent\n)\n=>\n{\nevent\n.\nnewDocument\n.\ndocumentElement\n.\ndataset\n.\ntheme\n=\nlocalStorage\n.\ngetItem\n(\n\"\ndarkMode\n\"\n)\n?\n\"\ndark\n\"\n:\n\"\nlight\n\"\n;\n});\n</\nscript\n>\nThe\nastro:before-swap\nevent can also be used to change the\nimplementation\nof the swap. The default swap implementation diffs head content, moves\npersistent\nelements from the old document to the\nnewDocument\n, and then replaces the entire\nbody\nwith the body of the new document.\nAt this point of the lifecycle, you could choose to define your own swap implementation, for example to diff the entire contents of the existing document (which some other routers do):\n<\nscript\nis:inline\n>\ndocument\n.\naddEventListener\n(\n\"\nastro:before-swap\n\"\n,\n(\nevent\n)\n=>\n{\nevent\n.\nswap\n=\n()\n=>\n{\ndiff\n(\ndocument\n,\nevent\n.\nnewDocument\n);\n};\n});\n</\nscript\n>\nBuilding a custom swap function\nSection titled \u201cBuilding a custom swap function\u201d\nAdded in:\nastro@4.15.0\nThe\nswapFunctions\nobject\nof the\nastro:transitions/client\nmodule provides five utility functions that handle specific swap-related tasks, including handling document attributes, page elements, and script execution. These functions can be used directly to define a custom swap implementation.\nThe following example demonstrates how to use these functions to recreate Astro\u2019s built-in swap implementation:\n<\nscript\n>\nimport\n{ swapFunctions }\nfrom\n\"\nastro:transitions/client\n\"\n;\n// substitutes `window.document` with `doc`\nfunction\nmySwap\n(\ndoc\n:\nDocument\n)\n{\nswapFunctions\n.\ndeselectScripts\n(\ndoc\n);\nswapFunctions\n.\nswapRootAttributes\n(\ndoc\n);\nswapFunctions\n.\nswapHeadElements\n(\ndoc\n);\nconst\nrestoreFocusFunction\n=\nswapFunctions\n.\nsaveFocus\n();\nswapFunctions\n.\nswapBodyElement\n(\ndoc\n.\nbody\n,\ndocument\n.\nbody\n);\nrestoreFocusFunction\n();\n}\ndocument\n.\naddEventListener\n(\n\"\nastro:before-swap\n\"\n,\n(\nevent\n)\n=>\n{\nevent\n.\nswap\n=\n()\n=>\nmySwap\n(\nevent\n.\nnewDocument\n);\n});\n<\nscript\n>\nCustom swap implementations can start with this template and add or replace individual steps with custom logic as needed.\nastro:after-swap\nSection titled \u201castro:after-swap\u201d\nAn event that fires immediately after the new page replaces the old page. You can listen to this event on the\ndocument\nand trigger actions that will occur before the new page\u2019s DOM elements render and scripts run.\nThis event, when listened to on the\noutgoing page\n, is useful to pass along and restore any state on the DOM that needs to transfer over to the new page.\nThis is the latest point in the lifecycle where it is still safe to, for example, add a dark mode class name (\n<html class=\"dark-mode\">\n), though you may wish to do so in an earlier event.\nThe\nastro:after-swap\nevent occurs immediately after the browser history has been updated and the scroll position has been set.\nTherefore, one use of targeting this event is to override the default scroll restore for history navigation. The following example resets the horizontal and vertical scroll position to the top left corner of the page for each navigation.\ndocument\n.\naddEventListener\n(\n\"\nastro:after-swap\n\"\n,\n()\n=>\nwindow\n.\nscrollTo\n({ left:\n0\n, top:\n0\n, behavior:\n\"\ninstant\n\"\n}),\n);\nastro:page-load\nSection titled \u201castro:page-load\u201d\nAn event that fires at the end of page navigation, after the new page is visible to the user and blocking styles and scripts are loaded. You can listen to this event on the\ndocument\n.\nThe\n<ClientRouter />\ncomponent fires this event both on initial page navigation for a pre-rendered page and on any subsequent navigation, either forwards or backwards.\nYou can use this event to run code on every page navigation, for example to set up event listeners that would otherwise be lost during navigation.\n<\nscript\n>\ndocument\n.\naddEventListener\n(\n\"\nastro:page-load\n\"\n,\n()\n=>\n{\n// This runs on first page load and after every navigation.\nsetupStuff\n();\n// e.g. add event listeners\n});\n</\nscript\n>\nAccessibility\nSection titled \u201cAccessibility\u201d\nEnabling client-side routing and animating page transitions both come with accessibility challenges, and Astro aims to make sites opting in to View Transitions as accessible-by-default as possible.\nRoute announcement\nSection titled \u201cRoute announcement\u201d\nAdded in:\nastro@3.2.0\nThe\n<ClientRouter />\ncomponent includes a route announcer for page navigation during client-side routing. No configuration or action is needed to enable this.\nAssistive technologies let visitors know that the page has changed by announcing the new page title after navigation. When using server-side routing with traditional full-page browser refreshes, this happens by default after the new page loads. In client-side routing, the\n<ClientRouter />\ncomponent performs this action.\nTo add route announcement to client-side routing, the component adds an element to the new page with the\naria-live\nattribute set to\nassertive\n. This tells AT (assistive technology) to announce immediately. The component also checks for the following, in priority order, to determine the announcement text:\nThe\n<title>\n, if it exists.\nThe first\n<h1>\nit finds.\nThe\npathname\nof the page.\nWe strongly recommend you always include a\n<title>\nin each page for accessibility.\nprefers-reduced-motion\nSection titled \u201cprefers-reduced-motion\u201d\nAstro\u2019s\n<ClientRouter />\ncomponent includes a CSS media query that disables\nall\nview transition animations, including fallback animation, whenever the\nprefers-reduced-motion\nsetting is detected. Instead, the browser will simply swap the DOM elements without an animation.\nLearn\nContribute\nCommunity\nSponsor",
  "content_markdown": "# View transitions\n\n[View transitions](https://developer.mozilla.org/en-US/docs/Web/API/View_Transition_API) are animated transitions between different website views. They are a popular design choice for preserving visual continuity as visitors move between states or views of an application.\n\nAstro\u2019s view transitions and client-side routing support is powered by the [View Transitions browser API](https://developer.chrome.com/docs/web-platform/view-transitions/) and also includes:\n\n- A few [built-in animation options](#built-in-animation-directives), such as `fade`, `slide`, and `none`.\n- Support for both forwards and backwards navigation animations.\n- The ability to fully [customize all aspects of transition animation](#customizing-animations), and build your own animations.\n- A way to carry HTML elements from the current page to the next during navigation.\n- The option to [prevent client-side navigation for non-page links](#preventing-client-side-navigation).\n- [Control over fallback behavior](#fallback-control) for browsers that do not yet support the View Transition APIs.\n- Automatic support for [`prefers-reduced-motion`](#prefers-reduced-motion).\n\n## Differences between browser-native view transitions and Astro\u2019s `<ClientRouter />`\n\n[Section titled \u201cDifferences between browser-native view transitions and Astro\u2019s <ClientRouter />\u201d](#differences-between-browser-native-view-transitions-and-astros-clientrouter-)\n\n[Browser-native, cross-document view transitions](https://developer.mozilla.org/en-US/docs/Web/API/View_Transition_API/Using#basic_mpa_view_transition) can be used in Astro to animate the navigation between documents in a multi-page app (MPA), often providing the experience of client-side routing of single-page applications. They don\u2019t alter the core functionality of a multi-page application, nor do they affect any existing scripts or add additional JavaScript to your page load. They simply add animations.\n\nFor enhanced client-side routing and view transition features not yet fully supported by the View Transition API, Astro provides a built-in, lightweight component to enable client-side routing and turn your multi-page app into a [single-page app](#enabling-view-transitions-spa-mode) with smooth animations on navigation.\n\nThat comes with some benefits, like shared state across pages and persistent elements, and some drawbacks, such as needing to manually reinitialize scripts or state after navigation.\n\nAdding Astro\u2019s built-in `<ClientRouter />` component:\n\n- [intercepts page navigation](#client-side-navigation-process) and gives you considerable control over this process.\n- extends and enhances some View Transition/Navigation API features.\n- allows you to [configure fallback strategies](#fallback-control) for when [native browser support is lacking](https://developer.mozilla.org/en-US/docs/Web/API/View_Transition_API#browser_compatibility).\n\nHowever, as browser APIs and web standards evolve, using Astro\u2019s `<ClientRouter />` for this additional functionality [will increasingly become unnecessary](https://astro.build/blog/future-of-astro-zero-js-view-transitions/). We recommend keeping up with the current state of browser APIs so you can [decide whether you still need Astro\u2019s client-side routing](https://events-3bg.pages.dev/jotter/astro-view-transitions/) for the specific features you use.\n\n## Enabling view transitions (SPA mode)\n\n[Section titled \u201cEnabling view transitions (SPA mode)\u201d](#enabling-view-transitions-spa-mode)\n\nImport and add the `<ClientRouter />` component to your common `<head>` or shared layout component. Astro will create default page animations based on the similarities between the old and new page, and will also provide fallback behavior for unsupported browsers.\n\nThe example below shows adding Astro\u2019s default page navigation animations site-wide, including the default fallback control option for non-supporting browsers, by importing and adding this component to a `<CommonHead />` Astro component:\n\nsrc/components/CommonHead.astro\n\n```\n---\n\nimport { ClientRouter } from \"astro:transitions\";\n\n---\n\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" />\n\n<meta name=\"generator\" content={Astro.generator} />\n\n<!-- Primary Meta Tags -->\n\n<title>{title}</title>\n\n<meta name=\"title\" content={title} />\n\n<meta name=\"description\" content={description} />\n\n<ClientRouter />\n```\n\nNo other configuration is necessary to enable Astro\u2019s default client-side navigation!\n\nUse [transition directives](#transition-directives) or [override default client-side navigation](#preventing-client-side-navigation) on individual elements for finer control.\n\n## Transition Directives\n\n[Section titled \u201cTransition Directives\u201d](#transition-directives)\n\nAstro will automatically assign corresponding elements found in both the old page and the new page a shared, unique `view-transition-name`. This pair of matching elements is inferred by both the type of element and its location in the DOM.\n\nUse optional `transition:*` directives on page elements in your `.astro` components for finer control over the page transition behaviour during navigation.\n\n- `transition:name`: Allows you to override Astro\u2019s default element matching for old/new content animation and [specify a transition name](#naming-a-transition) to associate a pair of DOM elements.\n- `transition:animate`: Allows you to override Astro\u2019s default animation while replacing the old element with the new one by specifying an animation type. Use Astro\u2019s [built-in animation directives](#built-in-animation-directives) or [create custom transition animations](#customizing-animations).\n- `transition:persist`: Allows you to override Astro\u2019s default replacing old elements for new ones and instead [persist components and HTML elements](#maintaining-state) when navigating to another page.\n\n### Naming a transition\n\n[Section titled \u201cNaming a transition\u201d](#naming-a-transition)\n\nIn some cases, you may want or need to identify the corresponding view transition elements yourself. You can specify a name for a pair of elements using the `transition:name` directive.\n\nsrc/pages/old-page.astro\n\n```\n<aside transition:name=\"hero\">\n```\n\nsrc/pages/new-page.astro\n\n```\n<aside transition:name=\"hero\">\n```\n\nNote that the provided `transition:name` value can only be used once on each page. Set this manually when Astro can\u2019t infer a proper name itself, or for more fine control over matching elements.\n\n### Maintaining State\n\n[Section titled \u201cMaintaining State\u201d](#maintaining-state)\n\n**Added in:**\n`astro@2.10.0`\n\nYou can persist components and HTML elements (instead of replacing them) across page navigations using the `transition:persist` directive.\n\nFor example, the following `<video>` will continue to play as you navigate to another page that contains the same video element. This works for both forwards and backwards navigation.\n\nsrc/components/Video.astro\n\n```\n<video controls muted autoplay transition:persist>\n\n<source\n\nsrc=\"https://ia804502.us.archive.org/33/items/GoldenGa1939_3/GoldenGa1939_3_512kb.mp4\"\n\ntype=\"video/mp4\"\n\n/>\n\n</video>\n```\n\nYou can also place the directive on an [Astro island](/en/concepts/islands/) (a UI framework component with a [`client:` directive](/en/reference/directives-reference/#client-directives)). If that component exists on the next page, the island from the old page **with its current state** will continue to be displayed, instead of replacing it with the island from the new page.\n\nIn the example below, the component\u2019s internal state of the count will not be reset when navigating back and forth across pages that contain the `<Counter />` component with the `transition:persist` attribute.\n\ncomponents/Header.astro\n\n```\n<Counter client:load transition:persist initialCount={5} />\n```\n\nYou can also [manually identify corresponding elements](#naming-a-transition) if the island/element is in a different component between the two pages.\n\nsrc/pages/old-page.astro\n\n```\n<video\n\ncontrols\n\nmuted\n\nautoplay\n\ntransition:name=\"media-player\"\n\ntransition:persist\n\n/>\n```\n\nsrc/pages/new-page.astro\n\n```\n<MyVideo\n\ncontrols\n\nmuted\n\nautoplay\n\ntransition:name=\"media-player\"\n\ntransition:persist\n\n/>\n```\n\nAs a convenient shorthand, `transition:persist` can alternatively take a transition name as a value.\n\nsrc/pages/index.astro\n\n```\n<video controls muted autoplay transition:persist=\"media-player\">\n```\n\n#### `transition:persist-props`\n\n[Section titled \u201ctransition:persist-props\u201d](#transitionpersist-props)\n\n**Added in:**\n`astro@4.5.0`\n\nThis allows you to control whether or not an island\u2019s props should be persisted upon navigation.\n\nBy default, when you add `transition:persist` to an island, the state is retained upon navigation, but your component will re-render with new props. This is useful, for example, when a component receives page-specific props such as the current page\u2019s `title`.\n\nYou can override this behavior by setting `transition:persist-props` in addition to `transition:persist`. Adding this directive will keep an island\u2019s existing props (not re-render with new values) in addition to maintaining its existing state.\n\n### Built-in Animation Directives\n\n[Section titled \u201cBuilt-in Animation Directives\u201d](#built-in-animation-directives)\n\nAstro comes with a few built-in animations to override the default `fade` transition. Add the `transition:animate` directive to individual elements to customize the behavior of specific transitions.\n\n- `fade` (default): An opinionated crossfade animation. The old content fades out and the new content fades in.\n- `initial`: Opt out of Astro\u2019s opinionated crossfade animation and use the browser\u2019s default styling.\n- `slide`: An animation where the old content slides out to the left and new content slides in from the right. On backwards navigation, the animations are the opposite.\n- `none`: Disable the browser\u2019s default animations. Use on a page\u2019s `<html>` element to disable the default fade for every element on the page.\n\nCombine directives for full control over your page animation. Set a page default on the `<html>` element, and override on any individual elements as desired.\n\nThe example below produces a slide animation for the body content while disabling the browser\u2019s default fade animation for the rest of the page:\n\n```\n---\n\nimport CommonHead from \"../components/CommonHead.astro\";\n\n---\n\n<html transition:name=\"root\" transition:animate=\"none\">\n\n<head>\n\n<CommonHead />\n\n</head>\n\n<body>\n\n<header>\n\n...\n\n</header>\n\n<!-- Override your page default on a single element -->\n\n<main transition:animate=\"slide\">\n\n...\n\n</main>\n\n</body>\n\n</html>\n```\n\n### Customizing Animations\n\n[Section titled \u201cCustomizing Animations\u201d](#customizing-animations)\n\nYou can customize all aspects of a transition with any CSS animation properties.\n\nTo customize a built-in animation, first import the animation from `astro:transitions`, and then pass in customization options.\n\nThe example below customizes the duration of the built-in `fade` animation:\n\n```\n---\n\nimport { fade } from \"astro:transitions\";\n\n---\n\n<header transition:animate={fade({ duration: \"0.4s\" })}>\n```\n\nYou can also define your own animations for use with `transition:animate` by defining both the forwards and backwards behavior, as well as new and old pages, according to the following types:\n\n```\nexport interface TransitionAnimation {\n\nname: string; // The name of the keyframe\n\ndelay?: number | string;\n\nduration?: number | string;\n\neasing?: string;\n\nfillMode?: string;\n\ndirection?: string;\n\n}\n\nexport interface TransitionAnimationPair {\n\nold: TransitionAnimation | TransitionAnimation[];\n\nnew: TransitionAnimation | TransitionAnimation[];\n\n}\n\nexport interface TransitionDirectionalAnimations {\n\nforwards: TransitionAnimationPair;\n\nbackwards: TransitionAnimationPair;\n\n}\n```\n\nThe following example shows all the necessary properties to define a custom `bump` animation inside a `<style is:global>` tag in your root layout file:\n\nsrc/layouts/Layout.astro\n\n```\n---\n\nimport { ClientRouter } from \"astro:transitions\";\n\n---\n\n<html lang=\"en\">\n\n<head>\n\n<ClientRouter />\n\n</head>\n\n<body>\n\n<slot />\n\n</body>\n\n</html>\n\n<style is:global>\n\n@keyframes bump {\n\n0% {\n\nopacity: 0;\n\ntransform: scale(1) translateX(200px);\n\n}\n\n50% {\n\nopacity: 0.5;\n\ntransform: scale(1.1);\n\n}\n\n100% {\n\nopacity: 1;\n\ntransform: scale(1) translateX(0);\n\n}\n\n}\n\n</style>\n```\n\nThe animation\u2019s behavior must be defined in the frontmatter of every component using the animation:\n\nsrc/pages/index.astro\n\n```\n---\n\nconst anim = {\n\nold: {\n\nname: \"bump\",\n\nduration: \"0.5s\",\n\neasing: \"ease-in\",\n\ndirection: \"reverse\",\n\n},\n\nnew: {\n\nname: \"bump\",\n\nduration: \"0.5s\",\n\neasing: \"ease-in-out\",\n\n},\n\n};\n\nconst customTransition = {\n\nforwards: anim,\n\nbackwards: anim,\n\n};\n\n---\n\n<header transition:animate={customTransition}> ... </header>\n```\n\nYou have great flexibility when defining custom animations. To achieve your desired result, you may wish to consider unusual combinations such as using different objects for forward and backward, or providing separate keyframe animations for old and new.\n\n## Router control\n\n[Section titled \u201cRouter control\u201d](#router-control)\n\nThe `<ClientRouter />` router handles navigation by listening to:\n\n- Clicks on `<a>` elements.\n- Backwards and forwards navigation events.\n\nThe following options allow you to further control when navigation occurs within the router:\n\n- `data-astro-reload`: an `<a>` tag attribute to [force a full-page navigation](#preventing-client-side-navigation)\n- `data-astro-history=\"auto | push | replace\"`: an `<a>` tag attribute to [control the browser\u2019s history](#replace-entries-in-the-browser-history)\n- `navigate(href, options)`: a method available to any client script or client component to [trigger navigation](#trigger-navigation)\n\n### Preventing client-side navigation\n\n[Section titled \u201cPreventing client-side navigation\u201d](#preventing-client-side-navigation)\n\nThere are some cases where you cannot navigate via client-side routing since both pages involved must use the `<ClientRouter />` router to prevent a full-page reload. You may also not want client-side routing on every navigation change and would prefer a traditional page navigation on select routes instead.\n\nYou can opt out of client-side routing on a per-link basis by adding the `data-astro-reload` attribute to any `<a>` or `<form>` tag. This attribute will override any existing `<ClientRouter />` component and instead trigger a browser refresh during navigation.\n\nThe following example shows preventing client-side routing when navigating to an article from the home page only. This still allows you to have animation on shared elements, such as a hero image, when navigating to the same page from an article listing page:\n\nsrc/pages/index.astro\n\n```\n<a href=\"/articles/emperor-penguins\" data-astro-reload>\n```\n\nsrc/pages/articles.astro\n\n```\n<a href=\"/articles/emperor-penguins\">\n```\n\nLinks with the `data-astro-reload` attribute will be ignored by the router and a full-page navigation will occur.\n\n### Trigger navigation\n\n[Section titled \u201cTrigger navigation\u201d](#trigger-navigation)\n\nYou can also trigger client-side navigation via events not normally listened to by the `<ClientRouter />` router using [`navigate()`](/en/reference/modules/astro-transitions/#navigate). This function from the `astro:transitions/client` module can be used in scripts, and in framework components that are hydrated with a [client directive](/en/reference/directives-reference/#client-directives).\n\nThe following example shows an Astro component that navigates a visitor to another page they select from a menu:\n\nsrc/components/Form.astro\n\n```\n<script>\n\nimport { navigate } from \"astro:transitions/client\";\n\n// Navigate to the selected option automatically.\n\ndocument.querySelector(\"select\").onchange = (event) => {\n\nlet href = event.target.value;\n\nnavigate(href);\n\n};\n\n</script>\n\n<select>\n\n<option value=\"/play\">Play</option>\n\n<option value=\"/blog\">Blog</option>\n\n<option value=\"/about\">About</option>\n\n<option value=\"/contact\">Contact</option>\n\n</select>\n```\n\nsrc/pages/index.astro\n\n```\n---\n\nimport Form from \"../components/Form.astro\";\n\nimport { ClientRouter } from \"astro:transitions\";\n\n---\n\n<html>\n\n<head>\n\n<ClientRouter />\n\n</head>\n\n<body>\n\n<Form />\n\n</body>\n\n</html>\n```\n\nThe following example implements the same using `navigate()` in a React `<Form />` component:\n\nsrc/components/Form.jsx\n\n```\nimport { navigate } from \"astro:transitions/client\";\n\nexport default function Form() {\n\nreturn (\n\n<select onChange={(e) => navigate(e.target.value)}>\n\n<option value=\"/play\">Play</option>\n\n<option value=\"/blog\">Blog</option>\n\n<option value=\"/about\">About</option>\n\n<option value=\"/contact\">Contact</option>\n\n</select>\n\n);\n\n}\n```\n\nThe `<Form />` component can then be rendered on an Astro page that uses the `<ClientRouter />` router, with a client directive:\n\nsrc/pages/index.astro\n\n```\n---\n\nimport Form from \"../components/Form.jsx\";\n\nimport { ClientRouter } from \"astro:transitions\";\n\n---\n\n<html>\n\n<head>\n\n<ClientRouter />\n\n</head>\n\n<body>\n\n<Form client:load />\n\n</body>\n\n</html>\n```\n\nFor backward and forward navigation through the browser history, you can combine `navigate()` with the built-in `history.back()`, `history.forward()` and `history.go()` functions of the browser. If `navigate()` is called during the server-side render of your component, it has no effect.\n\nSee the `astro:transitions` reference for more information about the [`navigate()` options](/en/reference/modules/astro-transitions/#navigate).\n\n### Replace entries in the browser history\n\n[Section titled \u201cReplace entries in the browser history\u201d](#replace-entries-in-the-browser-history)\n\nNormally, each time you navigate, a new entry is written to the browser\u2019s history. This allows navigation between pages using the browser\u2019s `back` and `forward` buttons.\n\nThe `<ClientRouter />` router allows you to overwrite history entries by adding the `data-astro-history` attribute to any individual `<a>` tag.\n\nThe `data-astro-history` attribute can be set to the same three values as the [`history` option of the `navigate()` function](/en/reference/modules/astro-transitions/#history-option):\n\n- `\"push\"`: the router will use `history.pushState` to create a new entry in the browser history.\n- `\"replace\"`: the router will use `history.replaceState` to update the URL without adding a new entry into navigation.\n- `\"auto\"` (default): the router will attempt `history.pushState`, but if the URL is not one that can be transitioned to, the current URL will remain with no changes to the browser history.\n\nThe following example navigates to the `/main` page but does not add a new entry to the browsing history. Instead, it reuses the current entry in the history (`/confirmation`) and overwrites it.\n\nsrc/pages/confirmation.astro\n\n```\n<a href=\"/main\" data-astro-history=\"replace\">\n```\n\nThis has the effect that if you go back from the `/main` page, the browser will not display the `/confirmation` page, but the page before it.\n\n### Transitions with forms\n\n[Section titled \u201cTransitions with forms\u201d](#transitions-with-forms)\n\n**Added in:**\n`astro@4.0.0`\n\nThe `<ClientRouter />` router will trigger in-page transitions from `<form>` elements, supporting both `GET` and `POST` requests.\n\nBy default, Astro submits your form data as `multipart/form-data` when your `method` is set to `POST`. If you want to match the default behavior of web browsers, use the `enctype` attribute to submit your data encoded as `application/x-www-form-urlencoded`:\n\nsrc/components/Form.astro\n\n```\n<form\n\naction=\"/contact\"\n\nmethod=\"POST\"\n\nenctype=\"application/x-www-form-urlencoded\"\n\n>\n```\n\nYou can opt out of router transitions on any individual form using the `data-astro-reload` attribute:\n\nsrc/components/Form.astro\n\n```\n<form action=\"/contact\" data-astro-reload>\n```\n\n### Navigating with user input\n\n[Section titled \u201cNavigating with user input\u201d](#navigating-with-user-input)\n\nThe `navigate()` API does not perform sanitization on the URLs passed to it. If you are using user input to determine the URL to navigate to, you should validate the input before passing it to `navigate()`.\n\nFor example, a `?redirect` query parameter could be used to navigate away from your site (`?redirect=http://example.com`) or to execute arbitrary code (`?redirect=javascript:alert('Evil code')`) if the value is not sanitized before use.\n\nOne way to implement this safely is to ensure only a set of known paths can be redirected to:\n\nsrc/pages/index.astro\n\n```\n<script>\n\nimport { navigate } from 'astro:transitions/client';\n\nconst params = new URLSearchParams(window.location.search);\n\nconst redirect = params.get('redirect');\n\nconst allowedPaths = ['/home', '/about', '/contact'];\n\nif (allowedPaths.includes(redirect)) {\n\nnavigate(redirect);\n\n}\n\n</script>\n```\n\nThe exact kind of sanitization you need will depend on your site and what you want to allow.\n\nConsider enabling Astro\u2019s [experimental Content Security Policy feature](/en/reference/experimental-flags/csp/) to help protect against cross-site scripting (XSS) risks if using user input with the `navigate()` API.\n\n## Fallback control\n\n[Section titled \u201cFallback control\u201d](#fallback-control)\n\nThe `<ClientRouter />` router works best in browsers that support View Transitions (i.e. Chromium browsers), but also includes default fallback support for other browsers. Even if the browser does not support the View Transitions API, Astro\u2019s client router can still provide in-browser navigation using one of the fallback options.\n\nDepending on browser support, you may need to explicitly set the `name` or `animate` [transition directives](#transition-directives) on the elements you wish to animate for a comparable experience across all browsers:\n\nsrc/pages/about.astro\n\n```\n---\n\nimport Layout from \"../layouts/LayoutUsingClientRouter.astro\";\n\n---\n\n<title transition:animate=\"fade\">About my site</title>\n```\n\nYou can override Astro\u2019s default fallback support by adding a `fallback` property on the `<ClientRouter />` component and setting it to `swap` or `none`:\n\n- `animate` (default, recommended): Astro will simulate view transitions using custom attributes before updating page content.\n- `swap`: Astro will not attempt to animate the page. Instead, the old page will be immediately replaced by the new one.\n- `none`: Astro will not do any animated page transitions at all. Instead, you will get full page navigation in non-supporting browsers.\n\n```\n---\n\nimport { ClientRouter } from \"astro:transitions\";\n\n---\n\n<title>My site</title>\n\n<ClientRouter fallback=\"swap\" />\n```\n\n## Client-side navigation process\n\n[Section titled \u201cClient-side navigation process\u201d](#client-side-navigation-process)\n\nWhen using the `<ClientRouter />` router, the following steps occur to produce Astro\u2019s client-side navigation:\n\n1. A visitor to your site triggers navigation by any of the following actions:\n\n   - Clicking an `<a>` tag linking internally to another page on your site.\n   - Clicking the back button.\n   - Clicking the forward button.\n2. The router starts fetching the next page.\n3. The router adds the `data-astro-transition` attribute to the HTML element with a value of `\"forward\"` or `\"back\"` as appropriate.\n4. The router calls `document.startViewTransition`. This triggers the browser\u2019s own [view transition process](https://developer.mozilla.org/en-US/docs/Web/API/View_Transition_API/Using#the_view_transition_process). Importantly, the browser screenshots the current state of the page.\n5. Inside the `startViewTransition` callback, the router performs a **swap**, which consists of the following sequence of events:\n\n   - The contents of the `<head>` are swapped out, with some elements kept:\n\n     - Stylesheet DOM nodes are left in if they exist on the new page, to prevent FOUC.\n     - Scripts are left in if they exist on the new page.\n     - Any other head elements with `transition:persist` are left in if there is a corresponding element in the new page.\n   - The `<body>` is completely replaced with the new page\u2019s body.\n   - Elements marked `transition:persist` are moved over to the new DOM if they exist on the new page.\n   - Scroll position is restored if necessary.\n   - The `astro:after-swap` event is triggered on the `document`. This is the end of the **swap** process.\n6. The router waits for any new stylesheets to load before resolving the transition.\n7. The router executes any new scripts added to the page.\n8. The `astro:page-load` event fires. This is the end of the navigation process.\n\n## Script behavior with view transitions\n\n[Section titled \u201cScript behavior with view transitions\u201d](#script-behavior-with-view-transitions)\n\nWhen you add view transitions to an existing Astro project, some of your scripts may no longer re-run after page navigation like they did with full-page browser refreshes. Use the following information to ensure that your scripts execute as expected.\n\n### Script order\n\n[Section titled \u201cScript order\u201d](#script-order)\n\nWhen navigating between pages with the `<ClientRouter />` component, scripts are run in sequential order to match browser behavior.\n\n### Script re-execution\n\n[Section titled \u201cScript re-execution\u201d](#script-re-execution)\n\n[Bundled module scripts](/en/guides/client-side-scripts/#script-processing), which are the default scripts in Astro, are only ever executed once. After initial execution they will be ignored, even if the script exists on the new page after a transition.\n\nUnlike bundled module scripts, [inline scripts](/en/guides/client-side-scripts/#unprocessed-scripts) have the potential to be re-executed during a user\u2019s visit to a site if they exist on a page that is visited multiple times. Inline scripts might also re-execute when a visitor navigates to a page without the script, and then back to one with the script.\n\nWith view transitions, some scripts may no longer re-run after page navigation like they do with full-page browser refreshes. There are several [events during client-side routing that you can listen for](#lifecycle-events), and fire events when they occur. You can wrap an existing script in an event listener to ensure it runs at the proper time in the navigation cycle.\n\nThe following example wraps a script for a mobile \u201chamburger\u201d menu in an event listener for `astro:page-load` which runs at the end of page navigation to make the menu responsive to being clicked after navigating to a new page:\n\nsrc/scripts/menu.js\n\n```\ndocument.addEventListener(\"astro:page-load\", () => {\n\ndocument.querySelector(\".hamburger\").addEventListener(\"click\", () => {\n\ndocument.querySelector(\".nav-links\").classList.toggle(\"expanded\");\n\n});\n\n});\n```\n\nThe following example shows a function that runs in response to the `astro:after-swap` event, which happens immediately after the new page has replaced the old page and before the DOM elements are painted to the screen. This avoids a flash of light mode theme after page navigation by checking and, if necessary, setting the dark mode theme before the new page is rendered:\n\nsrc/components/ThemeToggle.astro\n\n```\n<script is:inline>\n\nfunction applyTheme() {\n\nlocalStorage.theme === \"dark\"\n\n? document.documentElement.classList.add(\"dark\")\n\n: document.documentElement.classList.remove(\"dark\");\n\n}\n\ndocument.addEventListener(\"astro:after-swap\", applyTheme);\n\napplyTheme();\n\n</script>\n```\n\n#### `data-astro-rerun`\n\n[Section titled \u201cdata-astro-rerun\u201d](#data-astro-rerun)\n\n**Added in:**\n`astro@4.5.0`\n\nTo force inline scripts to re-execute after every transition, add the `data-astro-rerun` property. Adding any attribute to a script also implicitly adds `is:inline`, so this is only available for scripts that are not bundled and processed by Astro.\n\n```\n<script is:inline data-astro-rerun>...</script>\n```\n\nTo ensure that a script runs every time a page is loaded during client-side navigation, it should be executed by a [lifecycle event](#lifecycle-events). For example, event listeners for `DOMContentLoaded` can be replaced by the [`astro:page-load`](/en/guides/view-transitions/#astropage-load) lifecycle event.\n\nIf you have code that sets up a global state in an inline script, this state will need to take into account that the script might execute more than once. Check for the global state in your `<script>` tag, and conditionally execute your code where possible. This works because `window` is preserved.\n\n```\n<script is:inline>\n\nif (!window.SomeGlobal) {\n\nwindow.SomeGlobal = {};\n\n}\n\n</script>\n```\n\n## Lifecycle events\n\n[Section titled \u201cLifecycle events\u201d](#lifecycle-events)\n\nThe `<ClientRouter />` router fires a number of events on the `document` during navigation. These events provide hooks into the lifecycle of navigation, allowing you to do things like show indicators that a new page is loading, override default behavior, and restore state as navigation is completing.\n\nThe navigation process involves a **preparation** phase, when new content is loaded; a **DOM swap** phase, where the old page\u2019s content is replaced by the new page\u2019s content; and a **completion** phase where scripts are executed, loading is reported as completed and clean-up work is carried out.\n\nAstro\u2019s View Transition API lifecycle events in order are:\n\n- [`astro:before-preparation`](#astrobefore-preparation)\n- [`astro:after-preparation`](#astroafter-preparation)\n- [`astro:before-swap`](#astrobefore-swap)\n- [`astro:after-swap`](#astroafter-swap)\n- [`astro:page-load`](#astropage-load)\n\nWhile some actions can be triggered during any event, some tasks can only be performed during a specific event for best results, such as displaying a loading spinner before preparation or overriding animation pairs before swapping content.\n\n### `astro:before-preparation`\n\n[Section titled \u201castro:before-preparation\u201d](#astrobefore-preparation)\n\n**Added in:**\n`astro@3.6.0`\n\nAn event that fires at the beginning of the preparation phase, after navigation has started (e.g. after the user has clicked a link), but before content is loaded.\n\nThis event is used:\n\n- To do something before loading has started, such as showing a loading spinner.\n- To alter loading, such as loading content you\u2019ve defined in a template rather than from the external URL.\n- To change the `direction` of the navigation (which is usually either `forward` or `backward`) for custom animation.\n\nHere is an example of using the `astro:before-preparation` event to load a spinner before the content is loaded and stop it immediately after loading. Note that using the [`loader` callback](/en/reference/modules/astro-transitions/#loader) in this way allows asynchronous execution of code.\n\n```\n<script is:inline>\n\ndocument.addEventListener(\"astro:before-preparation\", (event) => {\n\nconst originalLoader = event.loader;\n\nevent.loader = async function () {\n\nconst { startSpinner } = await import(\"./spinner.js\");\n\nconst stop = startSpinner();\n\nawait originalLoader();\n\nstop();\n\n};\n\n});\n\n</script>\n```\n\n### `astro:after-preparation`\n\n[Section titled \u201castro:after-preparation\u201d](#astroafter-preparation)\n\n**Added in:**\n`astro@3.6.0`\n\nAn event that fires at the end of the preparation phase, after the new page\u2019s content has been loaded and parsed into a document. This event occurs before the view transitions phase.\n\nThis example uses the `astro:before-preparation` event to start a loading indicator and the `astro:after-preparation` event to stop it:\n\n```\n<script is:inline>\n\ndocument.addEventListener(\"astro:before-preparation\", () => {\n\ndocument.querySelector(\"#loading\").classList.add(\"show\");\n\n});\n\ndocument.addEventListener(\"astro:after-preparation\", () => {\n\ndocument.querySelector(\"#loading\").classList.remove(\"show\");\n\n});\n\n</script>\n```\n\nThis is a simpler version of loading a spinner than the example shown above: if all of the listener\u2019s code can be executed synchronously, there is no need to hook into the `loader` callback.\n\n### `astro:before-swap`\n\n[Section titled \u201castro:before-swap\u201d](#astrobefore-swap)\n\n**Added in:**\n`astro@3.6.0`\n\nAn event that fires before the new document (which is populated during the preparation phase) replaces the current document. This event occurs inside of the view transition, where the user is still seeing a snapshot of the old page.\n\nThis event can be used to make changes before the swap occurs. The `newDocument` property on the event represents the incoming document. Here is an example of ensuring the browser\u2019s light or dark mode preference in `localStorage` is carried over to the new page:\n\n```\n<script>\n\ndocument.addEventListener(\"astro:before-swap\", (event) => {\n\nevent.newDocument.documentElement.dataset.theme =\n\nlocalStorage.getItem(\"darkMode\") ? \"dark\" : \"light\";\n\n});\n\n</script>\n```\n\nThe `astro:before-swap` event can also be used to change the *implementation* of the swap. The default swap implementation diffs head content, moves **persistent** elements from the old document to the `newDocument`, and then replaces the entire `body` with the body of the new document.\n\nAt this point of the lifecycle, you could choose to define your own swap implementation, for example to diff the entire contents of the existing document (which some other routers do):\n\n```\n<script is:inline>\n\ndocument.addEventListener(\"astro:before-swap\", (event) => {\n\nevent.swap = () => {\n\ndiff(document, event.newDocument);\n\n};\n\n});\n\n</script>\n```\n\n#### Building a custom swap function\n\n[Section titled \u201cBuilding a custom swap function\u201d](#building-a-custom-swap-function)\n\n**Added in:**\n`astro@4.15.0`\n\nThe [`swapFunctions` object](/en/reference/modules/astro-transitions/#swapfunctions) of the `astro:transitions/client` module provides five utility functions that handle specific swap-related tasks, including handling document attributes, page elements, and script execution. These functions can be used directly to define a custom swap implementation.\n\nThe following example demonstrates how to use these functions to recreate Astro\u2019s built-in swap implementation:\n\n```\n<script>\n\nimport { swapFunctions } from \"astro:transitions/client\";\n\n// substitutes `window.document` with `doc`\n\nfunction mySwap(doc: Document) {\n\nswapFunctions.deselectScripts(doc);\n\nswapFunctions.swapRootAttributes(doc);\n\nswapFunctions.swapHeadElements(doc);\n\nconst restoreFocusFunction = swapFunctions.saveFocus();\n\nswapFunctions.swapBodyElement(doc.body, document.body);\n\nrestoreFocusFunction();\n\n}\n\ndocument.addEventListener(\"astro:before-swap\", (event) => {\n\nevent.swap = () => mySwap(event.newDocument);\n\n});\n\n<script>\n```\n\nCustom swap implementations can start with this template and add or replace individual steps with custom logic as needed.\n\n### `astro:after-swap`\n\n[Section titled \u201castro:after-swap\u201d](#astroafter-swap)\n\nAn event that fires immediately after the new page replaces the old page. You can listen to this event on the `document` and trigger actions that will occur before the new page\u2019s DOM elements render and scripts run.\n\nThis event, when listened to on the **outgoing page**, is useful to pass along and restore any state on the DOM that needs to transfer over to the new page.\n\nThis is the latest point in the lifecycle where it is still safe to, for example, add a dark mode class name (`<html class=\"dark-mode\">`), though you may wish to do so in an earlier event.\n\nThe `astro:after-swap` event occurs immediately after the browser history has been updated and the scroll position has been set.\nTherefore, one use of targeting this event is to override the default scroll restore for history navigation. The following example resets the horizontal and vertical scroll position to the top left corner of the page for each navigation.\n\n```\ndocument.addEventListener(\"astro:after-swap\", () =>\n\nwindow.scrollTo({ left: 0, top: 0, behavior: \"instant\" }),\n\n);\n```\n\n### `astro:page-load`\n\n[Section titled \u201castro:page-load\u201d](#astropage-load)\n\nAn event that fires at the end of page navigation, after the new page is visible to the user and blocking styles and scripts are loaded. You can listen to this event on the `document`.\n\nThe `<ClientRouter />` component fires this event both on initial page navigation for a pre-rendered page and on any subsequent navigation, either forwards or backwards.\n\nYou can use this event to run code on every page navigation, for example to set up event listeners that would otherwise be lost during navigation.\n\n```\n<script>\n\ndocument.addEventListener(\"astro:page-load\", () => {\n\n// This runs on first page load and after every navigation.\n\nsetupStuff(); // e.g. add event listeners\n\n});\n\n</script>\n```\n\n## Accessibility\n\n[Section titled \u201cAccessibility\u201d](#accessibility)\n\nEnabling client-side routing and animating page transitions both come with accessibility challenges, and Astro aims to make sites opting in to View Transitions as accessible-by-default as possible.\n\n### Route announcement\n\n[Section titled \u201cRoute announcement\u201d](#route-announcement)\n\n**Added in:**\n`astro@3.2.0`\n\nThe `<ClientRouter />` component includes a route announcer for page navigation during client-side routing. No configuration or action is needed to enable this.\n\nAssistive technologies let visitors know that the page has changed by announcing the new page title after navigation. When using server-side routing with traditional full-page browser refreshes, this happens by default after the new page loads. In client-side routing, the `<ClientRouter />` component performs this action.\n\nTo add route announcement to client-side routing, the component adds an element to the new page with the `aria-live` attribute set to `assertive`. This tells AT (assistive technology) to announce immediately. The component also checks for the following, in priority order, to determine the announcement text:\n\n- The `<title>`, if it exists.\n- The first `<h1>` it finds.\n- The `pathname` of the page.\n\nWe strongly recommend you always include a `<title>` in each page for accessibility.\n\n### `prefers-reduced-motion`\n\n[Section titled \u201cprefers-reduced-motion\u201d](#prefers-reduced-motion)\n\nAstro\u2019s `<ClientRouter />` component includes a CSS media query that disables *all* view transition animations, including fallback animation, whenever the [`prefers-reduced-motion`](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion) setting is detected. Instead, the browser will simply swap the DOM elements without an animation.\n\nLearn\n\n[Contribute](/en/contribute/)\n[Community](https://astro.build/chat)\n[Sponsor](https://opencollective.com/astrodotbuild)",
  "tags": [
    "astro",
    "static",
    "framework"
  ],
  "extracted_at": "2026-02-03T12:55:45.656206+00:00",
  "content_length": 34806,
  "content_hash": "74f1aa90abc685a3"
}