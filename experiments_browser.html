<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Experiments Browser Panel</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .exp-item { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; cursor: pointer; }
        .exp-header { display: flex; justify-content: space-between; }
        .exp-details { display: none; margin-top: 10px; }
        .file-list { list-style: none; padding-left: 0; }
        .file-list li { margin: 4px 0; }
        .status-success { color: green; }
        .status-fail { color: red; }
        .toggle::after { content: "▼"; margin-left: 5px; }
        .expanded .toggle::after { content: "▲"; }
    </style>
</head>
<body>
    <h1>Experiments Browser</h1>
    <div id="experiments-container">
        <!-- Experiment entries will be injected here -->
    </div>

    <script>
        // Mock data – replace with real data fetching logic
        const experiments = [
            {
                folder: "exp_20260203_220445_unified_session_8",
                timestamp: "2026-02-03 22:04:45",
                taskCount: 12,
                filesCreated: 34,
                status: "success",
                files: [
                    "main.py",
                    "utils.py",
                    "results/output.txt",
                    "logs/run.log"
                ]
            },
            {
                folder: "exp_20260202_180312_test_run",
                timestamp: "2026-02-02 18:03:12",
                taskCount: 8,
                filesCreated: 20,
                status: "fail",
                files: [
                    "script.py",
                    "error.log"
                ]
            }
            // Add more experiment objects as needed
        ];

        const container = document.getElementById('experiments-container');

        function createExpItem(exp) {
            const item = document.createElement('div');
            item.className = 'exp-item';

            const header = document.createElement('div');
            header.className = 'exp-header';

            const title = document.createElement('span');
            title.textContent = `${exp.folder} (${exp.timestamp})`;

            const meta = document.createElement('span');
            meta.innerHTML = `
                Tasks: ${exp.taskCount} |
                Files: ${exp.filesCreated} |
                Status: <span class="${exp.status === 'success' ? 'status-success' : 'status-fail'}">${exp.status}</span>
                <span class="toggle"></span>
            `;

            header.appendChild(title);
            header.appendChild(meta);
            item.appendChild(header);

            const details = document.createElement('div');
            details.className = 'exp-details';

            const fileList = document.createElement('ul');
            fileList.className = 'file-list';
            exp.files.forEach(f => {
                const li = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#`; // placeholder – replace with actual file view URL
                link.textContent = f;
                li.appendChild(link);
                fileList.appendChild(li);
            });
            details.appendChild(fileList);

            const diffLink = document.createElement('a');
            diffLink.href = `#`; // placeholder – replace with actual diff URL
            diffLink.textContent = 'View diffs';
            diffLink.style.display = 'block';
            diffLink.style.marginTop = '5px';
            details.appendChild(diffLink);

            item.appendChild(details);

            // Toggle expand/collapse
            header.addEventListener('click', () => {
                const expanded = item.classList.toggle('expanded');
                details.style.display = expanded ? 'block' : 'none';
            });

            return item;
        }

        // Render all experiments
        experiments.forEach(exp => {
            container.appendChild(createExpItem(exp));
        });
    </script>
</body>
</html>