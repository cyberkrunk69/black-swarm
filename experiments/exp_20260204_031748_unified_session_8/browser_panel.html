<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Experiment Browser Panel</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .exp-item { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        .exp-header { cursor: pointer; }
        .exp-details { display: none; margin-top: 10px; }
        .status-success { color: green; }
        .status-fail { color: red; }
        .file-list { list-style-type: none; padding-left: 0; }
        .file-list li { margin: 2px 0; }
    </style>
</head>
<body>
    <h1>Recent Experiments</h1>
    <div id="experiments"></div>

    <script>
        // Mock data - replace with dynamic loading as needed
        const experiments = [
            {
                folder: "exp_20260204_031748_unified_session_8",
                timestamp: "2026-02-04 03:17:48",
                taskCount: 5,
                filesCreated: 12,
                status: "success",
                files: [
                    "task1.py",
                    "task2.py",
                    "output.txt",
                    "diff.patch"
                ]
            },
            {
                folder: "exp_20260203_221010_sample",
                timestamp: "2026-02-03 22:10:10",
                taskCount: 3,
                filesCreated: 8,
                status: "fail",
                files: [
                    "run.py",
                    "error.log"
                ]
            }
        ];

        function createExpItem(exp) {
            const container = document.createElement('div');
            container.className = 'exp-item';

            const header = document.createElement('div');
            header.className = 'exp-header';
            header.innerHTML = `
                <strong>${exp.folder}</strong> |
                ${exp.timestamp} |
                Tasks: ${exp.taskCount} |
                Files: ${exp.filesCreated} |
                Status: <span class="${exp.status === 'success' ? 'status-success' : 'status-fail'}">${exp.status}</span>
            `;
            container.appendChild(header);

            const details = document.createElement('div');
            details.className = 'exp-details';
            const fileList = document.createElement('ul');
            fileList.className = 'file-list';
            exp.files.forEach(file => {
                const li = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#`; // placeholder for actual file view
                link.textContent = file;
                li.appendChild(link);
                if (file.endsWith('.patch') || file.endsWith('.diff')) {
                    const diffLink = document.createElement('a');
                    diffLink.href = `#`; // placeholder for diff view
                    diffLink.textContent = " (view diff)";
                    diffLink.style.marginLeft = "5px";
                    li.appendChild(diffLink);
                }
                fileList.appendChild(li);
            });
            details.appendChild(fileList);
            container.appendChild(details);

            header.addEventListener('click', () => {
                details.style.display = details.style.display === 'none' ? 'block' : 'none';
            });

            return container;
        }

        const expContainer = document.getElementById('experiments');
        experiments.forEach(exp => {
            expContainer.appendChild(createExpItem(exp));
        });
    </script>
</body>
</html>