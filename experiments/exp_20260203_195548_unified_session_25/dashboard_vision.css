:root {
    /* Timing */
    --anim-fast: 150ms;
    --anim-normal: 250ms;
    --anim-slow: 350ms;

    /* Easing */
    --ease-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
    --ease-snap: cubic-bezier(0.55, 0.055, 0.675, 0.19);

    /* Layout */
    --node-gap: 24px;
    --dashboard-width: 320px;
}

/* Global reset */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

/* Layout --------------------------------------------------- */
body {
    font-family: system-ui, sans-serif;
    background: #fafafa;
    color: #222;
    overflow: hidden;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header */
.dashboard-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    background: #fff;
    border-bottom: 1px solid #e0e0e0;
    gap: 1rem;
    flex-shrink: 0;
}
.dashboard-header .logo { font-weight: bold; font-size: 1.2rem; }
.dashboard-header .status,
.dashboard-header .stats { font-size: 0.9rem; }
.dashboard-header .autonomy-toggle label { cursor: pointer; }

/* Main area */
.dashboard-main {
    flex: 1;
    display: flex;
    position: relative;
}

/* Canvas */
.canvas-wrapper {
    flex: 1;
    overflow: hidden;
    position: relative;
}
.task-canvas {
    width: 100%;
    height: 100%;
}

/* History Dashboard */
.history-dashboard {
    width: var(--dashboard-width);
    background: #fff;
    border-left: 1px solid #e0e0e0;
    padding: 1rem;
    overflow-y: auto;
    transition: transform var(--anim-fast) var(--ease-snap);
    transform: translateX(0);
}
.history-dashboard.collapsed {
    transform: translateX(calc(var(--dashboard-width) + 1rem));
}
.history-dashboard .collapse-toggle {
    position: absolute;
    left: -2rem;
    top: 1rem;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
    cursor: pointer;
}
.history-dashboard h2 { margin-bottom: 0.5rem; font-size: 1.1rem; }
#history-list { list-style: none; }
#history-list li {
    padding: 0.4rem 0;
    border-bottom: 1px solid #f0f0f0;
    font-size: 0.9rem;
}

/* Input Section */
.input-section {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem;
}
#chat-input {
    width: 300px;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
}
#send-btn,
#mic-btn {
    padding: 0.5rem 0.8rem;
    border: none;
    background: #6366f1;
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
}
#mic-btn { background: #06b6d4; }

/* Nodes --------------------------------------------------- */
.node {
    cursor: pointer;
    transition:
        transform var(--anim-normal) var(--ease-bounce),
        opacity var(--anim-normal) var(--ease-snap);
}
.node circle {
    fill: var(--node-color);
    stroke: transparent;
    stroke-width: 3;
}

/* Node type colors */
.understanding { --node-color: #6366f1; } /* indigo */
.worker        { --node-color: #8b5cf6; } /* purple */
.helper        { --node-color: #06b6d4; } /* cyan */
.expert        { --node-color: #f59e0b; } /* amber */

/* Rainbow border for active nodes */
.active-rainbow {
    stroke: url(#rainbow-gradient);
    animation: rainbow-stroke 3s linear infinite;
}
@keyframes rainbow-stroke {
    0%   { stroke-dashoffset: 0; }
    100% { stroke-dashoffset: -200; }
}

/* Collapse animation (thunk‑thunk‑thunk) */
@keyframes thunk-collapse {
    0%   { transform: scale(1) translate(0,0); opacity: 1; }
    100% { transform: scale(0) translate(0,0); opacity: 0; }
}
.collapse-anim {
    animation: thunk-collapse var(--anim-normal) var(--ease-snap) forwards;
}

/* Connection lines */
.link {
    stroke: #bbb;
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 4 2;
    animation: dash 2s linear infinite;
}
@keyframes dash {
    to { stroke-dashoffset: -6; }
}